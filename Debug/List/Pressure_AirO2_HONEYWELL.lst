###############################################################################
#
# IAR ANSI C/C++ Compiler V7.40.3.8902/W32 for ARM        07/May/2017  09:24:29
# Copyright 1999-2015 IAR Systems AB.
#
#    Cpu mode     =  thumb
#    Endian       =  little
#    Source file  =  
#        E:\Ventilator\SoftWare\SVC_Software\SVC_Ver\SVC2_4_00
#        (960217)\modules\Source\Pressure_AirO2_HONEYWELL.c
#    Command line =  
#        "E:\Ventilator\SoftWare\SVC_Software\SVC_Ver\SVC2_4_00
#        (960217)\modules\Source\Pressure_AirO2_HONEYWELL.c" -D
#        USE_STDPERIPH_DRIVER -D STM32F40XX -lC
#        "E:\Ventilator\SoftWare\SVC_Software\SVC_Ver\SVC2_4_00
#        (960217)\Debug\List\" -o
#        "E:\Ventilator\SoftWare\SVC_Software\SVC_Ver\SVC2_4_00
#        (960217)\Debug\Obj\" --no_cse --no_unroll --no_inline --no_code_motion
#        --no_tbaa --no_clustering --no_scheduling --debug --endian=little
#        --cpu=Cortex-M4 -e --fpu=VFPv4_sp --dlib_config "C:\Program Files
#        (x86)\IAR Systems\Embedded Workbench
#        7.2\arm\INC\c\DLib_Config_Normal.h" -I
#        "E:\Ventilator\SoftWare\SVC_Software\SVC_Ver\SVC2_4_00
#        (960217)\board\" -I
#        "E:\Ventilator\SoftWare\SVC_Software\SVC_Ver\SVC2_4_00 (960217)\app\"
#        -I "E:\Ventilator\SoftWare\SVC_Software\SVC_Ver\SVC2_4_00
#        (960217)\Libraries\CMSIS\Device\ST\STM32F4xx\Include\" -I
#        "E:\Ventilator\SoftWare\SVC_Software\SVC_Ver\SVC2_4_00
#        (960217)\Libraries\STM32F4xx_StdPeriph_Driver\inc\" -I
#        "E:\Ventilator\SoftWare\SVC_Software\SVC_Ver\SVC2_4_00
#        (960217)\modules\Header\" -On --use_c++_inline -I "C:\Program Files
#        (x86)\IAR Systems\Embedded Workbench 7.2\arm\CMSIS\Include\"
#        --relaxed_fp
#    List file    =  
#        E:\Ventilator\SoftWare\SVC_Software\SVC_Ver\SVC2_4_00
#        (960217)\Debug\List\Pressure_AirO2_HONEYWELL.lst
#    Object file  =  
#        E:\Ventilator\SoftWare\SVC_Software\SVC_Ver\SVC2_4_00
#        (960217)\Debug\Obj\Pressure_AirO2_HONEYWELL.o
#
###############################################################################

E:\Ventilator\SoftWare\SVC_Software\SVC_Ver\SVC2_4_00  (960217)\modules\Source\Pressure_AirO2_HONEYWELL.c
      1          //------------------------------------------------------------------------------
      2          // SAADAT Co 
      3          // VENTILATOR 
      4          // DEVELOPER : MOJTABA REZAEI 
      5          // VER 1.0
      6          // 
      7          /*
      8          |------------------------------------------------------------------------------|
      9          |			***		Include		***														   |
     10          |------------------------------------------------------------------------------|
     11          */
     12          #include "Pressure_AirO2_HONEYWELL.h"
     13          /*
     14          |------------------------------------------------------------------------------|
     15          |     		***		Defines		***														   |
     16          |------------------------------------------------------------------------------|
     17          */
     18          extern  STRUCT_DATA_A2DSENSORS          DATA_Sensors;
     19          
     20          /*
     21          |------------------------------------------------------------------------------|
     22          |															***		Variables 		***												   |
     23          |------------------------------------------------------------------------------|
     24          */
     25          //-----------------------------------------------------------------------------|

   \                                 In section .text, align 2, keep-with-next
     26          void Pressure_INHEXH_HoneyWell_INITIALIZE(void)
     27          {
     28            return;
   \                     Pressure_INHEXH_HoneyWell_INITIALIZE: (+1)
   \   00000000   0x4770             BX       LR               ;; return
     29          }
     30          //-----------------------------------------------------------------------------|

   \                                 In section .text, align 4, keep-with-next
     31          void Read_Press_AIR_O2(void) /* HoneyWell */ //  Call Every 10 ms
     32          {  
   \                     Read_Press_AIR_O2: (+1)
   \   00000000   0xB580             PUSH     {R7,LR}
   \   00000002   0xED2D 0x8B02      VPUSH    {D8}
     33            static    u8    State_Process = 0;
     34            float     Temp_Press;
     35            //...................
     36            switch(State_Process)
   \   00000006   0x....             LDR.N    R0,??DataTable0_3
   \   00000008   0x7800             LDRB     R0,[R0, #+0]
   \   0000000A   0x2800             CMP      R0,#+0
   \   0000000C   0xD003             BEQ.N    ??Read_Press_AIR_O2_0
   \   0000000E   0x2802             CMP      R0,#+2
   \   00000010   0xD045             BEQ.N    ??Read_Press_AIR_O2_1
   \   00000012   0xD312             BCC.N    ??Read_Press_AIR_O2_2
   \   00000014   0xE070             B.N      ??Read_Press_AIR_O2_3
     37            {
     38              case 0://=====>> Start Read Pressure AIR
     39              GPIO_ResetBits(PRESSAIRCS_PORT, PRESSAIRCS_PIN); // CS LOW , AIR
   \                     ??Read_Press_AIR_O2_0: (+1)
   \   00000016   0x2102             MOVS     R1,#+2
   \   00000018   0x....             LDR.N    R0,??DataTable0_4  ;; 0x40020000
   \   0000001A   0x.... 0x....      BL       GPIO_ResetBits
     40              SPI_I2S_ITConfig(PRESS_AIRO2 , SPI_IT_RXNE , ENABLE );
   \   0000001E   0x2201             MOVS     R2,#+1
   \   00000020   0x2160             MOVS     R1,#+96
   \   00000022   0x....             LDR.N    R0,??DataTable0_5  ;; 0x40013000
   \   00000024   0x.... 0x....      BL       SPI_I2S_ITConfig
     41              SPI_I2S_SendData(PRESS_AIRO2,0xAA55);      // 0XAA55 is temporary data for read from SPI
   \   00000028   0xF64A 0x2155      MOVW     R1,#+43605
   \   0000002C   0x....             LDR.N    R0,??DataTable0_5  ;; 0x40013000
   \   0000002E   0x.... 0x....      BL       SPI_I2S_SendData
     42              State_Process = 1; // Goto Calculate Pressure AIR
   \   00000032   0x2001             MOVS     R0,#+1
   \   00000034   0x....             LDR.N    R1,??DataTable0_3
   \   00000036   0x7008             STRB     R0,[R1, #+0]
     43              break;
   \   00000038   0xE05E             B.N      ??Read_Press_AIR_O2_3
     44            case 1 ://=====>> Calculate Pressure AIR
     45              Temp_Press = (SPI_I2S_ReceiveData(PRESS_AIRO2) & 0x3FFF); //=> Delet Status Bits [31:30]
   \                     ??Read_Press_AIR_O2_2: (+1)
   \   0000003A   0x....             LDR.N    R0,??DataTable0_5  ;; 0x40013000
   \   0000003C   0x.... 0x....      BL       SPI_I2S_ReceiveData
   \   00000040   0x0480             LSLS     R0,R0,#+18       ;; ZeroExtS R0,R0,#+18,#+18
   \   00000042   0x0C80             LSRS     R0,R0,#+18
   \   00000044   0xEE00 0x0A10      VMOV     S0,R0
   \   00000048   0xEEB8 0x0AC0      VCVT.F32.S32 S0,S0
   \   0000004C   0xEEB0 0x8A40      VMOV.F32 S16,S0
     46              Temp_Press = (((Temp_Press - P_AIRO2_OUTPUTMIN)*(AIRO2_Pressure_MAX - AIRO2_Pressure_MIN))/(P_AIRO2_OUTPUTMAX - P_AIRO2_OUTPUTMIN)) + AIRO2_Pressure_MIN ;
   \   00000050   0xED9F 0x....      VLDR.W   S0,??DataTable0  ;; 0xc4ccc000
   \   00000054   0xEE38 0x0A00      VADD.F32 S0,S16,S0
   \   00000058   0xEDDF 0x....      VLDR.W   S1,??DataTable0_1  ;; 0x42c80000
   \   0000005C   0xEE20 0x0A20      VMUL.F32 S0,S0,S1
   \   00000060   0xEDDF 0x....      VLDR.W   S1,??DataTable0_2  ;; 0x464ccc00
   \   00000064   0xEE80 0x8A20      VDIV.F32 S16,S0,S1
     47              /*  Temp_Press = ((   Pout    - OSdig) / 2^14 ) * 150  */
     48              DATA_Sensors.Press_AIR = (u16)(Temp_Press * 100); /* 100=>2Decimal Place & 0.750=>>Convert mbar TO mmHg */  
   \   00000068   0xED9F 0x....      VLDR.W   S0,??DataTable0_1  ;; 0x42c80000
   \   0000006C   0xEE28 0x0A00      VMUL.F32 S0,S16,S0
   \   00000070   0xEEBD 0x0AC0      VCVT.S32.F32 S0,S0
   \   00000074   0xEE10 0x0A10      VMOV     R0,S0
   \   00000078   0x....             LDR.N    R1,??DataTable0_6
   \   0000007A   0x8088             STRH     R0,[R1, #+4]
     49              GPIO_SetBits(PRESSAIRCS_PORT , PRESSAIRCS_PIN);         // CS High
   \   0000007C   0x2102             MOVS     R1,#+2
   \   0000007E   0x....             LDR.N    R0,??DataTable0_4  ;; 0x40020000
   \   00000080   0x.... 0x....      BL       GPIO_SetBits
     50              //................ End Read AIR & Start Read O2
     51              GPIO_ResetBits(PRESSO2CS_PORT, PRESSO2CS_PIN); // CS LOW
   \   00000084   0x2104             MOVS     R1,#+4
   \   00000086   0x....             LDR.N    R0,??DataTable0_4  ;; 0x40020000
   \   00000088   0x.... 0x....      BL       GPIO_ResetBits
     52              SPI_I2S_SendData(PRESS_AIRO2,0xAA55);
   \   0000008C   0xF64A 0x2155      MOVW     R1,#+43605
   \   00000090   0x....             LDR.N    R0,??DataTable0_5  ;; 0x40013000
   \   00000092   0x.... 0x....      BL       SPI_I2S_SendData
     53              State_Process = 2; // Goto Calculate Pressure O2
   \   00000096   0x2002             MOVS     R0,#+2
   \   00000098   0x....             LDR.N    R1,??DataTable0_3
   \   0000009A   0x7008             STRB     R0,[R1, #+0]
     54              break;
   \   0000009C   0xE02C             B.N      ??Read_Press_AIR_O2_3
     55            case 2 ://=====>> Calculate Pressure O2
     56              Temp_Press = (SPI_I2S_ReceiveData(PRESS_AIRO2) & 0x3FFF); //=> Delet Status Bits [31:30]
   \                     ??Read_Press_AIR_O2_1: (+1)
   \   0000009E   0x....             LDR.N    R0,??DataTable0_5  ;; 0x40013000
   \   000000A0   0x.... 0x....      BL       SPI_I2S_ReceiveData
   \   000000A4   0x0480             LSLS     R0,R0,#+18       ;; ZeroExtS R0,R0,#+18,#+18
   \   000000A6   0x0C80             LSRS     R0,R0,#+18
   \   000000A8   0xEE00 0x0A10      VMOV     S0,R0
   \   000000AC   0xEEB8 0x0AC0      VCVT.F32.S32 S0,S0
   \   000000B0   0xEEB0 0x8A40      VMOV.F32 S16,S0
     57              Temp_Press = (((Temp_Press - P_AIRO2_OUTPUTMIN)*(AIRO2_Pressure_MAX - AIRO2_Pressure_MIN))/(P_AIRO2_OUTPUTMAX - P_AIRO2_OUTPUTMIN)) + AIRO2_Pressure_MIN ;
   \   000000B4   0xED9F 0x....      VLDR.W   S0,??DataTable0  ;; 0xc4ccc000
   \   000000B8   0xEE38 0x0A00      VADD.F32 S0,S16,S0
   \   000000BC   0xEDDF 0x....      VLDR.W   S1,??DataTable0_1  ;; 0x42c80000
   \   000000C0   0xEE20 0x0A20      VMUL.F32 S0,S0,S1
   \   000000C4   0xEDDF 0x....      VLDR.W   S1,??DataTable0_2  ;; 0x464ccc00
   \   000000C8   0xEE80 0x8A20      VDIV.F32 S16,S0,S1
     58              /*  Temp_Press = ((   Pout    - OSdig) / 2^14 ) * 150  */
     59              DATA_Sensors.Press_O2 = (u16)(Temp_Press * 100); /* 100=>2Decimal Place & 0.750=>>Convert mbar TO mmHg */  
   \   000000CC   0xED9F 0x....      VLDR.W   S0,??DataTable0_1  ;; 0x42c80000
   \   000000D0   0xEE28 0x0A00      VMUL.F32 S0,S16,S0
   \   000000D4   0xEEBD 0x0AC0      VCVT.S32.F32 S0,S0
   \   000000D8   0xEE10 0x0A10      VMOV     R0,S0
   \   000000DC   0x....             LDR.N    R1,??DataTable0_6
   \   000000DE   0x80C8             STRH     R0,[R1, #+6]
     60              SPI_I2S_ITConfig(PRESS_INHEXH , SPI_IT_RXNE , DISABLE );
   \   000000E0   0x2200             MOVS     R2,#+0
   \   000000E2   0x2160             MOVS     R1,#+96
   \   000000E4   0x....             LDR.N    R0,??DataTable0_7  ;; 0x40003c00
   \   000000E6   0x.... 0x....      BL       SPI_I2S_ITConfig
     61              GPIO_SetBits(PRESSO2CS_PORT, PRESSO2CS_PIN);         // CS High
   \   000000EA   0x2104             MOVS     R1,#+4
   \   000000EC   0x....             LDR.N    R0,??DataTable0_4  ;; 0x40020000
   \   000000EE   0x.... 0x....      BL       GPIO_SetBits
     62              State_Process = 0; // Return to Start Process 
   \   000000F2   0x2000             MOVS     R0,#+0
   \   000000F4   0x....             LDR.N    R1,??DataTable0_3
   \   000000F6   0x7008             STRB     R0,[R1, #+0]
     63              
     64           
     65              break;
     66            }
     67          }
   \                     ??Read_Press_AIR_O2_3: (+1)
   \   000000F8   0xECBD 0x8B02      VPOP     {D8}
   \   000000FC   0xBD01             POP      {R0,PC}          ;; return

   \                                 In section .bss, align 1
   \                     ??State_Process:
   \   00000000                      DS8 1

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable0:
   \   00000000   0xC4CCC000         DC32     0xc4ccc000

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable0_1:
   \   00000000   0x42C80000         DC32     0x42c80000

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable0_2:
   \   00000000   0x464CCC00         DC32     0x464ccc00

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable0_3:
   \   00000000   0x........         DC32     ??State_Process

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable0_4:
   \   00000000   0x40020000         DC32     0x40020000

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable0_5:
   \   00000000   0x40013000         DC32     0x40013000

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable0_6:
   \   00000000   0x........         DC32     DATA_Sensors

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable0_7:
   \   00000000   0x40003C00         DC32     0x40003c00
     68          /*
     69          |------------------------------------------------------------------------------|
     70          |                             ***         ***															   |
     71          |------------------------------------------------------------------------------|
     72          */
     73          
     74          
     75          

   Maximum stack usage in bytes:

   .cstack Function
   ------- --------
       0   Pressure_INHEXH_HoneyWell_INITIALIZE
      16   Read_Press_AIR_O2
        16   -> GPIO_ResetBits
        16   -> GPIO_SetBits
        16   -> SPI_I2S_ITConfig
        16   -> SPI_I2S_ReceiveData
        16   -> SPI_I2S_SendData


   Section sizes:

   Bytes  Function/Label
   -----  --------------
       4  ??DataTable0
       4  ??DataTable0_1
       4  ??DataTable0_2
       4  ??DataTable0_3
       4  ??DataTable0_4
       4  ??DataTable0_5
       4  ??DataTable0_6
       4  ??DataTable0_7
       2  Pressure_INHEXH_HoneyWell_INITIALIZE
     254  Read_Press_AIR_O2
       1  State_Process

 
   1 byte  in section .bss
 288 bytes in section .text
 
 288 bytes of CODE memory
   1 byte  of DATA memory

Errors: none
Warnings: none
